# Multi-Agent Example
# Multiple agents working together with conditional logic

version: "0.1"

project:
  name: multi-agent-example

providers:
  llm:
    openai:
      api_key: env:OPENAI_API_KEY
      default_params:
        temperature: 0.7
        max_tokens: 2000
    anthropic:
      api_key: env:ANTHROPIC_API_KEY
      default_params:
        temperature: 0.5
        max_tokens: 4000

policies:
  - name: fast
    budgets:
      max_cost_usd_per_run: 0.10
      timeout_seconds: 30

  - name: thorough
    budgets:
      max_cost_usd_per_run: 1.00
      timeout_seconds: 120

agents:
  - name: classifier
    provider: openai
    model:
      preference: gpt-4o-mini
    params:
      temperature: 0.1
    instructions: |
      You are a task classifier. Analyze the input and classify it.
      
      Categories:
      - "simple": Basic questions, greetings, simple tasks
      - "complex": Research, analysis, multi-step tasks
      
      Respond with ONLY the category name, nothing else.
    allow: []
    policy: fast

  - name: quick_responder
    provider: openai
    model:
      preference: gpt-4o-mini
    params:
      temperature: 0.7
    instructions: |
      You are a quick assistant. Give brief, helpful responses.
      Keep answers concise and to the point.
    allow: []
    policy: fast

  - name: deep_analyst
    provider: anthropic
    model:
      preference: claude-sonnet-4-5-20250929
    params:
      temperature: 0.3
      max_tokens: 4000
    instructions: |
      You are a thorough analyst. Provide detailed, well-researched responses.
      
      Structure your response with:
      1. Summary
      2. Detailed analysis
      3. Recommendations
      
      Be comprehensive and cite reasoning.
    allow: []
    policy: thorough

workflows:
  - name: smart_respond
    entry: classify
    steps:
      - id: classify
        type: llm
        agent: classifier
        input:
          task: $input.task
        save_as: classification
        next: route

      - id: route
        type: condition
        condition: $state.classification.response == "simple"
        on_true: quick_response
        on_false: deep_response

      - id: quick_response
        type: llm
        agent: quick_responder
        input:
          task: $input.task
        save_as: response
        next: end

      - id: deep_response
        type: llm
        agent: deep_analyst
        input:
          task: $input.task
        save_as: response
        next: end

      - id: end
        type: end

